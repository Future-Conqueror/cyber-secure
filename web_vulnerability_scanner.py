
import requests
from bs4 import BeautifulSoup

def find_forms(url):
    forms = []
    try:
        res = requests.get(url)
        soup = BeautifulSoup(res.content, "html.parser")
        forms = soup.find_all("form")
    except Exception as e:
        print(f"Error: {e}")
    return forms

def test_sql_injection(url):
    payload = "' OR '1'='1"
    try:
        res = requests.get(url + payload)
        if "error" in res.text.lower() or "sql" in res.text.lower():
            return True
    except:
        pass
    return False

def test_xss(url):
    payload = "<script>alert('XSS')</script>"
    try:
        res = requests.get(url + payload)
        if payload in res.text:
            return True
    except:
        pass
    return False

if __name__ == "__main__":
    target_url = input("Enter URL to scan: ")
    print("Checking forms...")
    forms = find_forms(target_url)
    print(f"Found {len(forms)} form(s).")

    print("Testing for SQL Injection...")
    if test_sql_injection(target_url):
        print("Possible SQL Injection vulnerability found!")
    else:
        print("No SQL Injection detected.")

    print("Testing for XSS...")
    if test_xss(target_url):
        print("Possible XSS vulnerability found!")
    else:
        print("No XSS detected.")
